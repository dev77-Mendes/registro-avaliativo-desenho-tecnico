<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registro Avaliativo â€“ Desenho TÃ©cnico</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8f9fa;
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
      color: #333;
    }
    .logo-container {
      text-align: center;
      margin-bottom: 20px;
    }
    .logo-container img {
      max-width: 220px;
      height: auto;
      border: none;
    }
    h1, h2 {
      text-align: center;
      color: #2c3e50;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    select, input, textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    .capacidades {
      background: #fff;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid #ddd;
    }
    .capacidade-item {
      margin: 8px 0;
    }
    .btn {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 10px;
      margin-right: 8px;
    }
    .btn:hover { background: #2980b9; }
    .btn-export { background: #27ae60; }
    .btn-export:hover { background: #219653; }
    .btn-reset { background: #e74c3c; }
    .btn-reset:hover { background: #c0392b; }
    .historico {
      margin-top: 30px;
      background: #fff;
      padding: 15px;
      border-radius: 6px;
      border: 1px solid #ddd;
    }
    .registro-item {
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    .registro-item:last-child { border: none; }
  </style>
</head>
<body>

  <!-- LOGO DO SENAI -->
  <div class="logo-container">
    <img src="https://www.senai.br/assets/images/logo-senai.svg" alt="SENAI">
  </div>

  <h1>Registro Avaliativo â€“ Desenho TÃ©cnico</h1>
  <h2>UC: Desenho TÃ©cnico Aplicado a Projetos ElÃ©tricos</h2>

  <div class="form-group">
    <label for="professor">Professor(a)</label>
    <input type="text" id="professor" placeholder="Seu nome">
  </div>

  <div class="form-group">
    <label for="aluno">Nome do(a) Aluno(a)</label>
    <input type="text" id="aluno" placeholder="Ex: Maria Silva">
  </div>

  <div class="form-group">
    <label for="aula">Aula (1 a 15)</label>
    <select id="aula">
      <option value="">Selecione a aula</option>
    </select>
  </div>

  <div class="capacidades" id="listaCapacidades">
    <p>Selecione uma aula para carregar as capacidades.</p>
  </div>

  <div class="form-group">
    <label for="observacao">ObservaÃ§Ãµes (opcional)</label>
    <textarea id="observacao" rows="3" placeholder="Ex: Demonstrou dificuldade com escala, mas corrigiu apÃ³s orientaÃ§Ã£o."></textarea>
  </div>

  <button class="btn" onclick="salvarRegistro()">Salvar Registro</button>
  <button class="btn btn-export" onclick="exportarRegistros()">Exportar Todos os Registros</button>
  <button class="btn btn-reset" onclick="resetarSistema()">ðŸ”„ Resetar Sistema</button>

  <div class="historico" id="historico">
    <h3>Registros Salvos</h3>
    <div id="listaRegistros"></div>
  </div>

  <script>
    const mapaCapacidades = {
      1: ["Reconhecer fundamentos do desenho tÃ©cnico", "Perceber importÃ¢ncia das normas", "Demonstrar responsabilidade"],
      2: ["Utilizar instrumentos de desenho", "Aplicar layout conforme NBR 10068", "AtenÃ§Ã£o aos detalhes"],
      3: ["Interpretar tipos de linhas (NBR 8403)", "Aplicar linhas em desenhos elÃ©tricos", "PrecisÃ£o grÃ¡fica"],
      4: ["Aplicar escalas (1:50, 1:100)", "Resolver regra de trÃªs", "DomÃ­nio de proporÃ§Ã£o"],
      5: ["Aplicar cotagem (NBR 10126)", "Usar unidades corretas (mm)", "Clareza na disposiÃ§Ã£o"],
      6: ["Diferenciar planta baixa, situaÃ§Ã£o e implantaÃ§Ã£o", "Interpretar plantas arquitetÃ´nicas", "Trabalho colaborativo"],
      7: ["Interpretar simbologia elÃ©trica (NBR 5444)", "Identificar sÃ­mbolos de tomadas, luzes, quadros", "Autonomia na leitura"],
      8: ["Interpretar diagramas unifilares/multifilares", "Representar circuitos", "Clareza tÃ©cnica"],
      9: ["Operar interface CAD", "Usar comandos bÃ¡sicos (linha, layer)", "OrganizaÃ§Ã£o de arquivos"],
      10: ["Inserir simbologia no CAD", "Usar layers por circuito", "Qualidade digital"],
      11: ["Aplicar NBR 5410", "Identificar falhas normativas", "Responsabilidade tÃ©cnica"],
      12: ["Calcular Ã¡reas e cargas", "Converter unidades", "Justificativa tÃ©cnica"],
      13: ["Aplicar LGPD", "Organizar pastas digitalmente", "Ã‰tica profissional"],
      14: ["Comunicar projeto com clareza", "Usar slides objetivos", "Assertividade"],
      15: ["Sintetizar conhecimentos", "Entregar projeto completo", "GestÃ£o de tempo e iniciativa"]
    };

    // âœ… TUDO dentro do DOMContentLoaded
    document.addEventListener('DOMContentLoaded', () => {
      const selectAula = document.getElementById('aula');
      
      // Preenche opÃ§Ãµes de aula
      for (let i = 1; i <= 15; i++) {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = `Aula ${i}`;
        selectAula.appendChild(opt);
      }

      // âœ… Evento de mudanÃ§a AGORA FUNCIONA
      selectAula.addEventListener('change', function() {
        const aula = this.value;
        const container = document.getElementById('listaCapacidades');
        if (!aula) {
          container.innerHTML = '<p>Selecione uma aula para carregar as capacidades.</p>';
          return;
        }
        const caps = mapaCapacidades[aula];
        let html = `<h4>Capacidades da Aula ${aula}:</h4>`;
        caps.forEach(cap => {
          html += `<div class="capacidade-item"><label><input type="checkbox" data-desc="${cap}"> ${cap}</label></div>`;
        });
        container.innerHTML = html;
      });

      // Carrega histÃ³rico e professor
      carregarHistorico();
      const savedProf = localStorage.getItem('professor_nome');
      if (savedProf) document.getElementById('professor').value = savedProf;
    });

    // FunÃ§Ãµes globais (fora do DOMContentLoaded, mas usam elementos jÃ¡ carregados)
    function salvarRegistro() {
      const prof = document.getElementById('professor').value.trim();
      const aluno = document.getElementById('aluno').value.trim();
      const aula = document.getElementById('aula').value;
      const obs = document.getElementById('observacao').value.trim();

      if (!aluno || !aula) return alert("Preencha o nome do aluno e selecione a aula.");
      if (prof) localStorage.setItem('professor_nome', prof);

      const checkboxes = document.querySelectorAll('#listaCapacidades input[type="checkbox"]:checked');
      const capacidades = Array.from(checkboxes).map(cb => cb.dataset.desc);

      const registro = {
        aluno,
        aula,
         new Date().toLocaleDateString('pt-BR'),
        capacidades,
        observacao: obs
      };

      localStorage.setItem(`registro_${aluno.replace(/\s+/g, '_')}_${aula}`, JSON.stringify(registro));
      alert(`Registro da Aula ${aula} salvo para ${aluno}!`);
      carregarHistorico();
      document.getElementById('observacao').value = '';
      document.querySelectorAll('#listaCapacidades input[type="checkbox"]').forEach(cb => cb.checked = false);
    }

    function carregarHistorico() {
      const container = document.getElementById('listaRegistros');
      container.innerHTML = '';
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.startsWith('registro_')) {
          const reg = JSON.parse(localStorage.getItem(key));
          const div = document.createElement('div');
          div.className = 'registro-item';
          div.innerHTML = `
            <strong>${reg.aluno}</strong> â€“ Aula ${reg.aula} (${reg.data})<br>
            <small>Capacidades: ${reg.capacidades.join('; ') || 'Nenhuma marcada'}</small><br>
            <em>${reg.observacao || ''}</em>
          `;
          container.appendChild(div);
        }
      }
    }

    function exportarRegistros() {
      let texto = "REGISTROS AVALIATIVOS â€“ Desenho TÃ©cnico\n========================================\n\n";
      let tem = false;
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.startsWith('registro_')) {
          tem = true;
          const r = JSON.parse(localStorage.getItem(key));
          texto += `Aluno: ${r.aluno}\nAula: ${r.aula}\nData: ${r.data}\nCapacidades: ${r.capacidades.join('; ') || 'Nenhuma'}\n`;
          if (r.observacao) texto += `ObservaÃ§Ã£o: ${r.observacao}\n`;
          texto += "\n---\n\n";
        }
      }
      if (!tem) return alert("Nenhum registro para exportar.");
      navigator.clipboard.writeText(texto).then(() => {
        alert("âœ… Registros copiados!\nCole em um documento ou use Ctrl+P para salvar como PDF.");
        window.print();
      }).catch(() => {
        alert("âš ï¸ NÃ£o foi possÃ­vel copiar. Mostre esta janela ao coordenador.");
      });
    }

    function resetarSistema() {
      if (confirm("âš ï¸ Isso apagarÃ¡ todos os registros das aulas (mas manterÃ¡ seu nome).\nDeseja continuar?")) {
        exportarRegistros(); // backup automÃ¡tico
        for (let i = localStorage.length - 1; i >= 0; i--) {
          const k = localStorage.key(i);
          if (k && k.startsWith('registro_')) localStorage.removeItem(k);
        }
        alert("âœ… Sistema resetado!");
        carregarHistorico();
        document.getElementById('aula').value = '';
        document.getElementById('listaCapacidades').innerHTML = '<p>Selecione uma aula para carregar as capacidades.</p>';
      }
    }
  </script>

</body>
</html>
